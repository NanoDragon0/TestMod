package me.nanodragon.testmod;

import java.util.ArrayList;

import com.google.common.eventbus.Subscribe;

import cpw.mods.fml.common.eventhandler.SubscribeEvent;
import me.nanodragon.testmod.Items.Vampire_sword;
import me.nanodragon.testmod.Utils.XPUnlock;
import net.minecraft.client.Minecraft;
import net.minecraft.enchantment.EnchantmentHelper;
import net.minecraft.entity.Entity;
import net.minecraft.entity.EntityLiving;
import net.minecraft.entity.EntityLivingBase;
import net.minecraft.entity.item.EntityItem;
import net.minecraft.entity.item.EntityXPOrb;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.item.Item;
import net.minecraft.item.ItemStack;
import net.minecraft.server.MinecraftServer;
import net.minecraft.util.DamageSource;
import net.minecraft.world.World;
import net.minecraftforge.event.entity.living.LivingDeathEvent;
import net.minecraftforge.event.entity.living.LivingDropsEvent;

public class ModEventHandler {

	@SubscribeEvent
	public void onEntityDeath(LivingDeathEvent event) { //Сущность умирает
		
		if(event.source.getEntity() != null && event.source.getEntity() instanceof EntityPlayer && ((EntityPlayer) event.source.getEntity()).getCurrentEquippedItem() != null) {
			
			ItemStack equip = ((EntityPlayer) event.source.getEntity()).getCurrentEquippedItem();
			if (EnchantmentHelper.getEnchantmentLevel(101, equip) > 0 && event.entityLiving instanceof EntityLiving) { //Обилие опыта
				
				int xp_addition = 10 * XPUnlock.getXP(((EntityLiving) event.entityLiving)) * EnchantmentHelper.getEnchantmentLevel(101, equip);
                event.entityLiving.worldObj.spawnEntityInWorld(new EntityXPOrb(event.entityLiving.worldObj, event.entityLiving.posX, event.entityLiving.posY, event.entityLiving.posZ, xp_addition));
			
			}
		}		
	}
	
	@SubscribeEvent
	public void LivingDropsEvent(LivingDropsEvent event, EntityLivingBase entity, DamageSource source, java.util.List<EntityItem> drops, int lootingLevel, boolean recentlyHit) {
		
		System.out.println("Тест");
		
		/*ItemStack equip = ((EntityPlayer) event.source.getEntity()).getCurrentEquippedItem();
		if (EnchantmentHelper.getEnchantmentLevel(102, equip) > 0) { //Телекинез
			
		}*/
		
	}
}
